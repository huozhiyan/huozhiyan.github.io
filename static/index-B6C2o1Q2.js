import{f as B,r as l,Q as U,a8 as b,h as C,i as T,M as n,G as p,K as f,F as D,$ as E,E as I,c as $,ae as F,j as P,H}from"./vue-CnshxKsO.js";import{_ as A}from"./index-B4YbGxTu.js";import"./element-Cu9Ufmt3.js";import"./vxe-Dy3nNYZ7.js";const M={class:"video-btn"},N=B({__name:"VideoHeader",emits:["play","pause","changeSpeed","changeText","start","stop","generatePic"],setup(L,{emit:r}){const u=l("speed x1"),c=l(!1),o=l(!1),i=l(""),y=U([{value:.5,label:"speed x0.5"},{value:1,label:"speed x1"},{value:2,label:"speed x2"}]),s=r,x=()=>{c.value=!0,s("play")},m=()=>{c.value=!1,s("pause")},_=k=>{s("changeSpeed",k)},h=()=>{s("changeText",i.value)},w=()=>{o.value=!0,x(),s("start",!0)},S=()=>{o.value=!1,m(),s("stop",!1)},R=()=>{s("generatePic")};return(k,g)=>{const d=b("el-button"),v=b("el-divider"),V=b("el-input"),e=b("el-option"),a=b("el-select");return C(),T("div",M,[n(d,null,{default:p(()=>[f("视频设置")]),_:1}),n(v,{direction:"vertical"}),n(V,{class:"text",placeholder:"修改画布文本",maxlength:"10","show-word-limit":"",modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=t=>i.value=t),onChange:h},null,8,["modelValue"]),n(v,{direction:"vertical"}),n(a,{class:"select-width",placeholder:"动画速度",modelValue:u.value,"onUpdate:modelValue":g[1]||(g[1]=t=>u.value=t),onChange:_},{default:p(()=>[(C(!0),T(D,null,E(y,t=>(C(),I(e,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(v,{direction:"vertical"}),n(d,{type:"primary",onClick:x,disabled:c.value},{default:p(()=>[f("播放")]),_:1},8,["disabled"]),n(d,{type:"danger",onClick:m,disabled:!c.value},{default:p(()=>[f("暂停")]),_:1},8,["disabled"]),n(v,{direction:"vertical"}),n(d,{type:"primary",onClick:w,disabled:o.value},{default:p(()=>[f("开始录制")]),_:1},8,["disabled"]),n(d,{type:"danger",onClick:S,disabled:!o.value},{default:p(()=>[f("结束录制")]),_:1},8,["disabled"]),n(v,{direction:"vertical"}),n(d,{onClick:R},{default:p(()=>[f("生成图片")]),_:1})])}}}),O=A(N,[["__scopeId","data-v-622eb5c0"]]),j={class:"outer"},G={"element-loading-text":"正在录制...","element-loading-background":"rgba(122, 122, 122, 0.4)"},z=B({__name:"index",setup(L){const r=l(),u=l(1),c=l(0),o=l(110),i=l("rich-vue3"),y=l(20),s=l("orange"),x=l("px Arial"),m=l(!1),_=l(null);let h=U([]);const w=()=>{const e=r.value,a=e.getContext("2d");a.clearRect(0,0,e.width,e.height),a.font=y.value+x.value,a.fillStyle=s.value,a.fillText(i.value,o.value,e.height/2)},S=()=>{if(c.value)return;const e=r.value,a=e.getContext("2d");c.value=setInterval(()=>{a.clearRect(0,0,e.width,e.height),a.font=y.value+x.value,a.fillStyle=s.value,a.fillText(i.value,o.value,e.height/2),o.value+=u.value/2,(o.value>e.width||o.value<5)&&(u.value=-u.value)},10)},R=()=>{clearInterval(c.value),c.value=0},k=e=>{u.value=e},g=e=>{i.value=e||i.value,w()},d=()=>{m.value=!0,h=[];const a=r.value.captureStream(60);_.value=new MediaRecorder(a,{mimeType:"video/webm;codecs=vp9"}),_.value.ondataavailable=t=>{h.push(t.data)},_.value.start(10)},v=()=>{if(m.value=!1,!h.length)return;_.value.stop();const e=document.createElement("a");e.style.display="none";const a=new Blob(h);e.href=window.URL.createObjectURL(a),e.download="rich-vue3.webm",document.body.appendChild(e),e.click(),e.remove()},V=()=>{const e=r.value,a=e==null?void 0:e.toDataURL("image/png"),t=document.createElement("a");t.href=a,t.download=`${i.value}.png`,document.body.appendChild(t),t.click(),document.body.removeChild(t)};return $(()=>{w()}),(e,a)=>{const t=F("loading");return C(),T("div",null,[n(O,{onChangeSpeed:k,onChangeText:g,onPlay:S,onPause:R,onStart:d,onStop:v,onGeneratePic:V}),P("div",j,[H((C(),T("div",G,[P("canvas",{ref_key:"richCanvas",ref:r,class:"canvas"},null,512)])),[[t,m.value]])])])}}}),W=A(z,[["__scopeId","data-v-612f82a2"]]);export{W as default};
